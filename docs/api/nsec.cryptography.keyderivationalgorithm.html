<!DOCTYPE html>
<html lang="en"><head><title>KeyDerivationAlgorithm Class | NSec</title><meta content="Represents a key derivation algorithm using keying material as input." name="description"><link href="https://nsec.rocks/docs/api/nsec.cryptography.keyderivationalgorithm" rel="canonical"><link href="/style.css" rel="stylesheet"><meta content="width=device-width, initial-scale=1" name="viewport"></head><body><header><div class="icons"><a class="icon nuget-icon" href="https://www.nuget.org/packages/NSec.Cryptography/25.4.0" title="NuGet"></a><a class="icon github-icon" href="https://github.com/ektrah/nsec" title="GitHub"></a></div><nav><ol typeof="BreadcrumbList" vocab="https://schema.org/"><li property="itemListElement" typeof="ListItem"><a href="/" property="item" typeof="WebPage"><span property="name">NSec</span></a><meta content="1" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/" property="item" typeof="WebPage"><span property="name">NSec Documentation</span></a><meta content="2" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/" property="item" typeof="WebPage"><span property="name">API Reference</span></a><meta content="3" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/nsec.cryptography" property="item" typeof="WebPage"><span property="name">NSec.Cryptography</span></a><meta content="4" property="position"></li> / <li property="itemListElement" typeof="ListItem"><span property="name">KeyDerivationAlgorithm</span><meta content="5" property="position"></li></ol></nav></header><main><h1>KeyDerivationAlgorithm Class</h1><p>Represents a key derivation algorithm using keying material as input.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> KeyDerivationAlgorithm : Algorithm</pre><div class="admonition note"><p class="admonition-title">Note</p><p>The <a href="/docs/api/nsec.cryptography.keyderivationalgorithm">KeyDerivationAlgorithm</a> class requires
cryptographically suitable input keying material. To derive keys from
passwords, use the
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm">PasswordBasedKeyDerivationAlgorithm</a> class.</p></div><h2 id="inheritance-hierarchy">Inheritance Hierarchy</h2><ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm</a><ul><li><strong>KeyDerivationAlgorithm</strong><ul><li><a href="/docs/api/nsec.cryptography.keyderivationalgorithm2">KeyDerivationAlgorithm2</a><ul><li>HkdfSha256</li><li>HkdfSha512</li></ul></li></ul></li></ul></li></ul><h2 id="summary">Summary</h2><nav><ul><li><a href="#static-properties">Static Properties</a><ul><li><a href="#hkdfsha256">HkdfSha256</a></li><li><a href="#hkdfsha512">HkdfSha512</a></li></ul></li><li><a href="#properties">Properties</a><ul><li><a href="#maxcount">MaxCount</a></li><li><a href="#maxsaltsize">MaxSaltSize</a></li><li><a href="#minsaltsize">MinSaltSize</a></li></ul></li><li><a href="#methods">Methods</a><ul><li><a href="#derivebytes-sharedsecret-or-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-int">DeriveBytes(SharedSecret or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, int)</a></li><li><a href="#derivebytes-sharedsecret-or-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-span-byte">DeriveBytes(SharedSecret or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</a></li><li><a href="#derivekey-sharedsecret-or-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-algorithm-in-keycreationparameters">DeriveKey(SharedSecret or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Algorithm, in KeyCreationParameters)</a></li></ul></li><li><a href="#thread-safety">Thread Safety</a></li><li><a href="#purity">Purity</a></li><li><a href="#see-also">See Also</a></li></ul></nav><h2 id="static-properties">Static Properties</h2><h3 id="hkdfsha256">HkdfSha256</h3><p>Gets the HKDF-SHA256 key derivation algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> HkdfSha256 HkdfSha256 { <span class="k">get</span>; }</pre><h3 id="hkdfsha512">HkdfSha512</h3><p>Gets the HKDF-SHA512 key derivation algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> HkdfSha512 HkdfSha512 { <span class="k">get</span>; }</pre><h2 id="properties">Properties</h2><h3 id="maxcount">MaxCount</h3><p>Gets the maximum number of bytes that can be derived from a shared secret.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MaxCount { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The maximum size, in bytes, of the key derivation output.</p><h3 id="maxsaltsize">MaxSaltSize</h3><p>Gets the maximum size of the salt used for key derivation.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MaxSaltSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The maximum salt size, in bytes.</p><h3 id="minsaltsize">MinSaltSize</h3><p>Gets the minimum size of the salt used for key derivation.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MinSaltSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The minimum salt size, in bytes.</p><h2 id="methods">Methods</h2><h3 id="derivebytes-sharedsecret-or-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-int">DeriveBytes(SharedSecret or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, int)</h3><p>Derives the specified number of bytes from a shared secret or some other input keying material, using the specified
salt and context information.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">byte</span>[] DeriveBytes(
    SharedSecret sharedSecret,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; info,
    <span class="k">int</span> count)

<span class="k">public</span> <span class="k">byte</span>[] DeriveBytes(
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; inputKeyingMaterial,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; info,
    <span class="k">int</span> count)</pre><h4>Parameters</h4><dl><dt>sharedSecret</dt><dd>The <a href="/docs/api/nsec.cryptography.sharedsecret">SharedSecret</a> to derive the bytes from.</dd><dt>inputKeyingMaterial</dt><dd>The input keying material to derive the bytes from.</dd><dt>salt</dt><dd>Optional salt.</dd><dt>info</dt><dd>Context and application specific information. This should be used to ensure
that the derived bytes are adequately bound to the context of the key
agreement.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>Inadequate context information might lead to subtle vulnerabilities.</p></div><dl><dd>To bind the derived bytes to the context, <code>info</code> may need to include the
identifiers of the entities involved, their public keys, protocol-related
information, and parameter choices. </dd><dt>count</dt><dd>The number of bytes to derive.</dd></dl><h4>Return Value</h4><p>An array of bytes that contains the derived bytes.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>sharedSecret</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>inputKeyingMaterial</code> is empty.</dd><dt>ArgumentException</dt><dd><code>salt.Length</code> is less than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#minsaltsize">MinSaltSize</a>
or greater than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#maxsaltsize">MaxSaltSize</a>.</dd><dt>ArgumentOutOfRangeException</dt><dd><code>count</code> is less than 0 or greater than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#maxcount">MaxCount</a>.</dd><dt>ObjectDisposedException</dt><dd><code>sharedSecret</code> has been disposed.</dd></dl><h3 id="derivebytes-sharedsecret-or-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-span-byte">DeriveBytes(SharedSecret or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</h3><p>Fills the specified span of bytes with bytes derived from a shared secret or some other input keying material, using
the specified salt and context information.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">void</span> DeriveBytes(
    SharedSecret sharedSecret,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; info,
    Span&lt;<span class="k">byte</span>&gt; bytes)

<span class="k">public</span> <span class="k">void</span> DeriveBytes(
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; inputKeyingMaterial,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; info,
    Span&lt;<span class="k">byte</span>&gt; bytes)</pre><h4>Parameters</h4><dl><dt>sharedSecret</dt><dd>The <a href="/docs/api/nsec.cryptography.sharedsecret">SharedSecret</a> to derive the bytes from.</dd><dt>inputKeyingMaterial</dt><dd>The input keying material to derive the bytes from.</dd><dt>salt</dt><dd>Optional salt.</dd><dt>info</dt><dd>Context and application specific information. This should be used to ensure
that the derived bytes are adequately bound to the context of the key
agreement.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>Inadequate context information might lead to subtle vulnerabilities.</p></div><dl><dd>To bind the derived bytes to the context, <code>info</code> may need to include the
identifiers of the entities involved, their public keys, protocol-related
information, and parameter choices. </dd><dt>bytes</dt><dd>The span to fill with bytes derived from the shared secret.
<code>bytes</code> must not overlap in memory with <code>salt</code> or <code>info</code>.</dd></dl><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>sharedSecret</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>inputKeyingMaterial</code> is empty.</dd><dt>ArgumentException</dt><dd><code>salt.Length</code> is less than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#minsaltsize">MinSaltSize</a>
or greater than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#maxsaltsize">MaxSaltSize</a>.</dd><dt>ArgumentException</dt><dd><code>bytes.Length</code> is greater than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#maxcount">MaxCount</a>.</dd><dt>ArgumentException</dt><dd><code>bytes</code> overlaps in memory with <code>salt</code> or <code>info</code>.</dd><dt>ObjectDisposedException</dt><dd><code>sharedSecret</code> has been disposed.</dd></dl><h3 id="derivekey-sharedsecret-or-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-algorithm-in-keycreationparameters">DeriveKey(SharedSecret or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Algorithm, in KeyCreationParameters)</h3><p>Derives a key for the specified algorithm from a shared secret or some other input keying material, using the
specified salt and context information.</p><pre data-lang="C#"><span class="k">public</span> Key DeriveKey(
    SharedSecret sharedSecret,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; info,
    Algorithm algorithm,
    <span class="k">in</span> KeyCreationParameters creationParameters = <span class="k">default</span>)

<span class="k">public</span> Key DeriveKey(
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; inputKeyingMaterial,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; info,
    Algorithm algorithm,
    <span class="k">in</span> KeyCreationParameters creationParameters = <span class="k">default</span>)</pre><h4>Parameters</h4><dl><dt>sharedSecret</dt><dd>The <a href="/docs/api/nsec.cryptography.sharedsecret">SharedSecret</a> to derive the key from.</dd><dt>inputKeyingMaterial</dt><dd>The input keying material to derive the bytes from.</dd><dt>salt</dt><dd>Optional salt.</dd><dt>info</dt><dd>Context and application specific information. This should be used to ensure
that the derived key is adequately bound to the context of the key
agreement.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>Inadequate context information might lead to subtle vulnerabilities.</p></div><dl><dd>To bind the derived key to the context, <code>info</code> may need to include the
identifiers of the entities involved, their public keys, protocol-related
information, and parameter choices. </dd><dt>algorithm</dt><dd>The algorithm for the new key.</dd><dt>creationParameters</dt><dd>A <a href="/docs/api/nsec.cryptography.keycreationparameters">KeyCreationParameters</a> value that specifies
advanced parameters for the creation of the <a href="/docs/api/nsec.cryptography.key">Key</a> instance.</dd></dl><h4>Return Value</h4><p>A new instance of the <a href="/docs/api/nsec.cryptography.key">Key</a> class that represents the derived key.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>sharedSecret</code> or <code>algorithm</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>inputKeyingMaterial</code> is empty.</dd><dt>ArgumentException</dt><dd><code>salt.Length</code> is less than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#minsaltsize">MinSaltSize</a>
or greater than
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm#maxsaltsize">MaxSaltSize</a>.</dd><dt>NotSupportedException</dt><dd>The specified algorithm does not support keys derived from a shared secret.</dd><dt>ObjectDisposedException</dt><dd><code>sharedSecret</code> has been disposed.</dd></dl><h2 id="thread-safety">Thread Safety</h2><p>All members of this type are thread safe.</p><h2 id="purity">Purity</h2><p>All methods yield the same result for the same arguments.</p><h2 id="see-also">See Also</h2><ul><li>API Reference<ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm Class</a></li><li><a href="/docs/api/nsec.cryptography.keyderivationalgorithm2">KeyDerivationAlgorithm2 Class</a></li><li><a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm">PasswordBasedKeyDerivationAlgorithm Class</a></li><li><a href="/docs/api/nsec.cryptography.sharedsecret">SharedSecret Class</a></li></ul></li></ul></main><footer><p><a href="/license" rel="terms-of-use">&#169; 2025 Individual Contributors</a></p></footer></body></html>