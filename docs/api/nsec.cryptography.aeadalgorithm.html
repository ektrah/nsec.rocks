<!DOCTYPE html>
<html lang="en"><head><title>AeadAlgorithm Class | NSec</title><meta content="Represents an authenticated encryption with associated data (AEAD) algorithm." name="description"><link href="https://nsec.rocks/docs/api/nsec.cryptography.aeadalgorithm" rel="canonical"><link href="/style.css" rel="stylesheet"><meta content="width=device-width, initial-scale=1" name="viewport"></head><body><header><div class="icons"><a class="icon nuget-icon" href="https://www.nuget.org/packages/NSec.Cryptography/25.4.0" title="NuGet"></a><a class="icon github-icon" href="https://github.com/ektrah/nsec" title="GitHub"></a></div><nav><ol typeof="BreadcrumbList" vocab="https://schema.org/"><li property="itemListElement" typeof="ListItem"><a href="/" property="item" typeof="WebPage"><span property="name">NSec</span></a><meta content="1" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/" property="item" typeof="WebPage"><span property="name">NSec Documentation</span></a><meta content="2" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/" property="item" typeof="WebPage"><span property="name">API Reference</span></a><meta content="3" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/nsec.cryptography" property="item" typeof="WebPage"><span property="name">NSec.Cryptography</span></a><meta content="4" property="position"></li> / <li property="itemListElement" typeof="ListItem"><span property="name">AeadAlgorithm</span><meta content="5" property="position"></li></ol></nav></header><main><h1>AeadAlgorithm Class</h1><p>Represents an authenticated encryption with associated data (AEAD) algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> AeadAlgorithm : Algorithm</pre><h2 id="inheritance-hierarchy">Inheritance Hierarchy</h2><ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm</a><ul><li><strong>AeadAlgorithm</strong><ul><li>Aegis128L</li><li>Aegis256</li><li>Aes256Gcm</li><li>ChaCha20Poly1305</li><li>XChaCha20Poly1305</li></ul></li></ul></li></ul><h2 id="summary">Summary</h2><nav><ul><li><a href="#static-properties">Static Properties</a><ul><li><a href="#aegis128l">Aegis128L</a></li><li><a href="#aegis256">Aegis256</a></li><li><a href="#aes256gcm">Aes256Gcm</a></li><li><a href="#chacha20poly1305">ChaCha20Poly1305</a></li><li><a href="#xchacha20poly1305">XChaCha20Poly1305</a></li></ul></li><li><a href="#properties">Properties</a><ul><li><a href="#keysize">KeySize</a></li><li><a href="#noncesize">NonceSize</a></li><li><a href="#tagsize">TagSize</a></li></ul></li><li><a href="#methods">Methods</a><ul><li><a href="#encrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte">Encrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;)</a></li><li><a href="#encrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-span-byte">Encrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</a></li><li><a href="#decrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte">Decrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;)</a></li><li><a href="#decrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-span-byte">Decrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</a></li></ul></li><li><a href="#thread-safety">Thread Safety</a></li><li><a href="#purity">Purity</a></li><li><a href="#see-also">See Also</a></li></ul></nav><h2 id="static-properties">Static Properties</h2><h3 id="aegis128l">Aegis128L</h3><p>Gets the AEGIS-128L AEAD algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Aegis128L Aegis128L { <span class="k">get</span>; }</pre><h3 id="aegis256">Aegis256</h3><p>Gets the AEGIS-256 AEAD algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Aegis256 Aegis256 { <span class="k">get</span>; }</pre><h3 id="aes256gcm">Aes256Gcm</h3><p>Gets the AES256-GCM AEAD algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Aes256Gcm Aes256Gcm { <span class="k">get</span>; }</pre><h4>Exceptions</h4><dl><dt>PlatformNotSupportedException</dt><dd>The platform does not support hardware-accelerated AES.</dd></dl><h4>Remarks</h4><p>The AES-GCM implementation in NSec is hardware-accelerated and may not be
available on all architectures. Support can be determined at runtime using
the static <code>IsSupported</code> property of the <code>NSec.Cryptography.Aes256Gcm</code> class.</p><h3 id="chacha20poly1305">ChaCha20Poly1305</h3><p>Gets the ChaCha20-Poly1305 AEAD algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> ChaCha20Poly1305 ChaCha20Poly1305 { <span class="k">get</span>; }</pre><h3 id="xchacha20poly1305">XChaCha20Poly1305</h3><p>Gets the XChaCha20-Poly1305 AEAD algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> XChaCha20Poly1305 XChaCha20Poly1305 { <span class="k">get</span>; }</pre><h2 id="properties">Properties</h2><h3 id="keysize">KeySize</h3><p>Gets the size of the key used for encryption and decryption.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> KeySize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The key size, in bytes.</p><h3 id="noncesize">NonceSize</h3><p>Gets the size of the nonce used for encryption and decryption.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> NonceSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The nonce size, in bytes.</p><h3 id="tagsize">TagSize</h3><p>Gets the size of the authentication tag.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> TagSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The authentication tag size, in bytes.</p><h2 id="methods">Methods</h2><h3 id="encrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte">Encrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;)</h3><p>Encrypts the specified plaintext using the specified key, nonce, and associated
data, and returns the ciphertext, which includes an authentication tag, as an
array of bytes.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">byte</span>[] Encrypt(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; nonce,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; associatedData,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; plaintext)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The <a href="/docs/api/nsec.cryptography.key">Key</a> to use for encryption.
This must be a cryptographically strong key as created by the
<a href="/docs/api/nsec.cryptography.key#create">Key.Create</a> method, not a password.</dd><dt>nonce</dt><dd>The nonce to use for encryption.
The same nonce must not be used more than once to encrypt data with the
specified key.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>Using the same nonce with the same key more than once leads to
catastrophic loss of security.</p></div><dl><dd>To prevent nonce reuse when encrypting multiple plaintexts with the same key,
it is recommended to increment the previous nonce. A randomly generated
nonce is unsafe unless the <a href="/docs/api/nsec.cryptography.aeadalgorithm#noncesize">nonce size</a>
is at least 24 bytes.</dd><dt>associatedData</dt><dd>Optional additional data to be authenticated during decryption.</dd><dt>plaintext</dt><dd>The data to encrypt.</dd></dl><h4>Return Value</h4><p>An array of bytes that contains the encrypted data and the authentication tag.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.aeadalgorithm">AeadAlgorithm</a> object.</dd><dt>ArgumentException</dt><dd><code>nonce.Length</code> is not equal to <a href="/docs/api/nsec.cryptography.aeadalgorithm#noncesize">NonceSize</a>.</dd><dt>ArgumentException</dt><dd><code>plaintext.Length</code> plus <a href="/docs/api/nsec.cryptography.aeadalgorithm#tagsize">TagSize</a> is greater
than <code>int.MaxValue</code>.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h3 id="encrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-span-byte">Encrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</h3><p>Encrypts the specified plaintext using the specified key, nonce, and associated
data, and fills the specified span of bytes with the ciphertext, which includes
an authentication tag.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">void</span> Encrypt(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; nonce,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; associatedData,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; plaintext,
    Span&lt;<span class="k">byte</span>&gt; ciphertext)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The <a href="/docs/api/nsec.cryptography.key">Key</a> to use for encryption.
This must be a cryptographically strong key as created by the
<a href="/docs/api/nsec.cryptography.key#create">Key.Create</a> class, not a password.</dd><dt>nonce</dt><dd>The nonce to use for encryption.
The same nonce must not be used more than once to encrypt data with the
specified key.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>Using the same nonce with the same key more than once leads to
catastrophic loss of security.</p></div><dl><dd>To prevent nonce reuse when encrypting multiple plaintexts with the same key,
it is recommended to increment the previous nonce. A randomly generated
nonce is unsafe unless the <a href="/docs/api/nsec.cryptography.aeadalgorithm#noncesize">nonce size</a>
is at least 24 bytes.</dd><dt>associatedData</dt><dd>Optional additional data to be authenticated during decryption.</dd><dt>plaintext</dt><dd>The data to encrypt.</dd><dt>ciphertext</dt><dd>The span to fill with the encrypted data and the authentication tag.
The length of the span must be equal to <code>plaintext.Length</code> plus
<a href="/docs/api/nsec.cryptography.aeadalgorithm#tagsize">TagSize</a>.</dd><dd><code>ciphertext</code> must not overlap in memory with <code>plaintext</code>, except if
<code>ciphertext</code> and <code>plaintext</code> point at exactly the same memory location
(in-place encryption).</dd></dl><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.aeadalgorithm">AeadAlgorithm</a> object.</dd><dt>ArgumentException</dt><dd><code>nonce.Length</code> is not equal to <a href="/docs/api/nsec.cryptography.aeadalgorithm#noncesize">NonceSize</a>.</dd><dt>ArgumentException</dt><dd><code>ciphertext.Length</code> is not equal to <code>plaintext.Length</code> plus
<a href="/docs/api/nsec.cryptography.aeadalgorithm#tagsize">TagSize</a>.</dd><dt>ArgumentException</dt><dd><code>ciphertext</code> overlaps in memory with <code>plaintext</code>.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h3 id="decrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte">Decrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;)</h3><p>Decrypts and authenticates the specified ciphertext using the specified key,
nonce, and associated data. If successful, returns the decrypted plaintext as an
array of bytes.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">byte</span>[]? Decrypt(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; nonce,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; associatedData,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; ciphertext)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The <a href="/docs/api/nsec.cryptography.key">Key</a> to use for decryption.
Authentication fails if this is not the same key that was used for
encryption.</dd><dt>nonce</dt><dd>The nonce to use for decryption.
Authentication fails if this is not the same nonce that was used for
encryption.</dd><dt>associatedData</dt><dd>Optional additional data to authenticate.
Authentication fails if this is not the same additional data that was used
for encryption.</dd><dt>ciphertext</dt><dd>The encrypted data to authenticate and decrypt.
Authentication fails if the integrity of the data was compromised.</dd></dl><h4>Return Value</h4><p>An array of bytes that contains the decrypted and authenticated data, or
<code>null</code> if authentication fails.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.aeadalgorithm">AeadAlgorithm</a> object.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h3 id="decrypt-key-readonlyspan-byte-readonlyspan-byte-readonlyspan-byte-span-byte">Decrypt(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</h3><p>Decrypts and authenticates the specified ciphertext using the specified key,
nonce, and associated data. If successful, fills the specified span of bytes
with the decrypted plaintext.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">bool</span> Decrypt(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; nonce,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; associatedData,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; ciphertext,
    Span&lt;<span class="k">byte</span>&gt; plaintext)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The <a href="/docs/api/nsec.cryptography.key">Key</a> to use for decryption.
Authentication fails if this is not the same key that was used for
encryption.</dd><dt>nonce</dt><dd>The nonce to use for decryption.
Authentication fails if this is not the same nonce that was used for
encryption.</dd><dt>associatedData</dt><dd>Optional additional data to authenticate.
Authentication fails if this is not the same additional data that was used
for encryption.</dd><dt>ciphertext</dt><dd>The encrypted data to authenticate and decrypt.
Authentication fails if the integrity of the data was compromised.</dd><dt>plaintext</dt><dd>The span to fill with the decrypted and authenticated data.
The length of the span must be equal to <code>ciphertext.Length</code> minus
<a href="/docs/api/nsec.cryptography.aeadalgorithm#tagsize">TagSize</a>.</dd><dd><code>plaintext</code> must not overlap in memory with <code>ciphertext</code>, except if
<code>plaintext</code> and <code>ciphertext</code> point at exactly the same memory location
(in-place decryption).</dd></dl><h4>Return Value</h4><p><code>true</code> if decryption and authentication succeed; otherwise, <code>false</code>.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.aeadalgorithm">AeadAlgorithm</a> object.</dd><dt>ArgumentException</dt><dd><code>plaintext.Length</code> is not equal to <code>ciphertext.Length</code> minus
<a href="/docs/api/nsec.cryptography.aeadalgorithm#tagsize">TagSize</a>.</dd><dt>ArgumentException</dt><dd><code>plaintext</code> overlaps in memory with <code>ciphertext</code>.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h2 id="thread-safety">Thread Safety</h2><p>All members of this type are thread safe.</p><h2 id="purity">Purity</h2><p>All methods yield the same result for the same arguments.</p><h2 id="see-also">See Also</h2><ul><li>API Reference<ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm Class</a></li><li><a href="/docs/api/nsec.cryptography.key">Key Class</a></li></ul></li></ul></main><footer><p><a href="/license" rel="terms-of-use">&#169; 2025 Individual Contributors</a></p></footer></body></html>