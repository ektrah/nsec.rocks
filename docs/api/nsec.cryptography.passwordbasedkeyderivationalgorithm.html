<!DOCTYPE html>
<html lang="en"><head><title>PasswordBasedKeyDerivationAlgorithm Class | NSec</title><meta content="Represents a key derivation algorithm using passwords as input." name="description"><link href="https://nsec.rocks/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm" rel="canonical"><link href="/style.css" rel="stylesheet"><meta content="width=device-width, initial-scale=1" name="viewport"></head><body><header><div class="icons"><a class="icon nuget-icon" href="https://www.nuget.org/packages/NSec.Cryptography/25.4.0" title="NuGet"></a><a class="icon github-icon" href="https://github.com/ektrah/nsec" title="GitHub"></a></div><nav><ol typeof="BreadcrumbList" vocab="https://schema.org/"><li property="itemListElement" typeof="ListItem"><a href="/" property="item" typeof="WebPage"><span property="name">NSec</span></a><meta content="1" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/" property="item" typeof="WebPage"><span property="name">NSec Documentation</span></a><meta content="2" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/" property="item" typeof="WebPage"><span property="name">API Reference</span></a><meta content="3" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/nsec.cryptography" property="item" typeof="WebPage"><span property="name">NSec.Cryptography</span></a><meta content="4" property="position"></li> / <li property="itemListElement" typeof="ListItem"><span property="name">PasswordBasedKeyDerivationAlgorithm</span><meta content="5" property="position"></li></ol></nav></header><main><h1>PasswordBasedKeyDerivationAlgorithm Class</h1><p>Represents a key derivation algorithm using passwords as input.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> PasswordBasedKeyDerivationAlgorithm : Algorithm</pre><div class="admonition note"><p class="admonition-title">Note</p><p>The <a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm">PasswordBasedKeyDerivationAlgorithm</a> class is intended for deriving keys from passwords. To derive keys from
cryptographically strong input keying material, use the
<a href="/docs/api/nsec.cryptography.keyderivationalgorithm2">KeyDerivationAlgorithm2</a> class.</p></div><h2 id="inheritance-hierarchy">Inheritance Hierarchy</h2><ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm</a><ul><li><strong>PasswordBasedKeyDerivationAlgorithm</strong><ul><li>Argon2id</li><li>Scrypt</li></ul></li></ul></li></ul><h2 id="summary">Summary</h2><nav><ul><li><a href="#static-methods">Static Methods</a><ul><li><a href="#argon2id-in-argon2parameters">Argon2id(in Argon2Parameters)</a></li><li><a href="#scrypt-in-scryptparameters">Scrypt(in ScryptParameters)</a></li></ul></li><li><a href="#properties">Properties</a><ul><li><a href="#maxcount">MaxCount</a></li><li><a href="#maxsaltsize">MaxSaltSize</a></li><li><a href="#minsaltsize">MinSaltSize</a></li></ul></li><li><a href="#methods">Methods</a><ul><li><a href="#derivebytes-string-or-readonlyspan-byte-readonlyspan-byte-int">DeriveBytes(string or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, int)</a></li><li><a href="#derivebytes-string-or-readonlyspan-byte-readonlyspan-byte-span-byte">DeriveBytes(string or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</a></li><li><a href="#derivekey-string-or-readonlyspan-byte-readonlyspan-byte-algorithm-in-keycreationparameters">DeriveKey(string or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Algorithm, in KeyCreationParameters)</a></li></ul></li><li><a href="#thread-safety">Thread Safety</a></li><li><a href="#purity">Purity</a></li><li><a href="#see-also">See Also</a></li></ul></nav><h2 id="static-methods">Static Methods</h2><h3 id="argon2id-in-argon2parameters">Argon2id(in Argon2Parameters)</h3><p>Gets the Argon2id algorithm with the specified parameters.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Argon2id Argon2id(
    <span class="k">in</span> Argon2Parameters parameters)</pre><h4>Parameters</h4><dl><dt>parameters</dt><dd>An <a href="/docs/api/nsec.cryptography.argon2parameters">Argon2Parameters</a> value that specifies the
parameters to use with the Argon2id algorithm.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>The parameters must be tuned according to the amount of memory and computing
power available. Poor parameter choices can be harmful for security.</p></div><h4>Return Value</h4><p>An instance of the
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm">PasswordBasedKeyDerivationAlgorithm</a> class.</p><h4>Exceptions</h4><dl><dt>ArgumentException</dt><dd>The specified parameters are out of the range of valid values.
 See the <a href="/docs/api/nsec.cryptography.argon2parameters">Argon2Parameters</a> struct for details.</dd></dl><h3 id="scrypt-in-scryptparameters">Scrypt(in ScryptParameters)</h3><p>Gets the scrypt algorithm with the specified parameters.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Scrypt Scrypt(
    <span class="k">in</span> ScryptParameters parameters)</pre><h4>Parameters</h4><dl><dt>parameters</dt><dd>A <a href="/docs/api/nsec.cryptography.scryptparameters">ScryptParameters</a> value that specifies the
parameters to use with the scrypt algorithm.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>The parameters must be tuned according to the amount of memory and computing
power available. Poor parameter choices can be harmful for security.</p></div><h4>Return Value</h4><p>An instance of the
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm">PasswordBasedKeyDerivationAlgorithm</a> class.</p><h4>Exceptions</h4><dl><dt>ArgumentException</dt><dd>The specified parameters are out of the range of valid values.
 See the <a href="/docs/api/nsec.cryptography.scryptparameters">ScryptParameters</a> struct for details.</dd></dl><h2 id="properties">Properties</h2><h3 id="maxcount">MaxCount</h3><p>Gets the maximum number of bytes that can be derived from a password.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MaxCount { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The maximum size, in bytes, of the key derivation output.</p><h3 id="maxsaltsize">MaxSaltSize</h3><p>Gets the maximum size of the salt used for key derivation.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MaxSaltSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The maximum salt size, in bytes.</p><h3 id="minsaltsize">MinSaltSize</h3><p>Gets the minimum size of the salt used for key derivation.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MinSaltSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The minimum salt size, in bytes.</p><h2 id="methods">Methods</h2><h3 id="derivebytes-string-or-readonlyspan-byte-readonlyspan-byte-int">DeriveBytes(string or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, int)</h3><p>Derives the specified number of bytes from a password, using the specified salt.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">byte</span>[] DeriveBytes(
    <span class="k">string</span> password,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    <span class="k">int</span> count)

<span class="k">public</span> <span class="k">byte</span>[] DeriveBytes(
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; password,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    <span class="k">int</span> count)</pre><div class="admonition note"><p class="admonition-title">Note</p><p>Depending on algorithm parameters, this method may need a long time and/or
large amounts of memory. Callers should protect against a denial-of-service
attack resulting from careless invocation.</p></div><h4>Parameters</h4><dl><dt>password</dt><dd>The password to derive the bytes from.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>If the password is a <code>string</code>, the bytes are derived from the in-memory
representation of the string. This may lead to different results on
different hardware platforms. For portable results, the password should
be first converted to bytes using one of the character encoding classes
in .NET.</p></div><dl><dt>salt</dt><dd>The salt.</dd><dt>count</dt><dd>The number of bytes to derive.</dd></dl><h4>Return Value</h4><p>An array of bytes that contains the derived bytes.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>password</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>salt.Length</code> is less than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#minsaltsize">MinSaltSize</a>
or greater than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#maxsaltsize">MaxSaltSize</a>.</dd><dt>ArgumentOutOfRangeException</dt><dd><code>count</code> is less than 0 or greater than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#maxcount">MaxCount</a>.</dd><dt>CryptographicException</dt><dd>The computation of the derived bytes failed, usually because the operating
system refused to allocate the amount of requested memory.</dd></dl><h3 id="derivebytes-string-or-readonlyspan-byte-readonlyspan-byte-span-byte">DeriveBytes(string or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</h3><p>Fills the specified span of bytes with bytes derived from a password, using the
specified salt.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">void</span> DeriveBytes(
    <span class="k">string</span> password,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    Span&lt;<span class="k">byte</span>&gt; bytes)

<span class="k">public</span> <span class="k">void</span> DeriveBytes(
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; password,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    Span&lt;<span class="k">byte</span>&gt; bytes)</pre><div class="admonition note"><p class="admonition-title">Note</p><p>Depending on algorithm parameters, this method may need a long time and/or
large amounts of memory. Callers should protect against a denial-of-service
attack resulting from careless invocation.</p></div><h4>Parameters</h4><dl><dt>password</dt><dd>The password to derive the bytes from.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>If the password is a <code>string</code>, the bytes are derived from the in-memory
representation of the string. This may lead to different results on
different hardware platforms. For portable results, the password should
be first converted to bytes using one of the character encoding classes
in .NET.</p></div><dl><dt>salt</dt><dd>The salt.</dd><dt>bytes</dt><dd>The span to fill with bytes derived from the password.</dd></dl><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>password</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>salt.Length</code> is less than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#minsaltsize">MinSaltSize</a>
or greater than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#maxsaltsize">MaxSaltSize</a>.</dd><dt>ArgumentException</dt><dd><code>bytes.Length</code> is greater than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#maxcount">MaxCount</a>.</dd><dt>CryptographicException</dt><dd>The computation of the derived bytes failed, usually because the operating
system refused to allocate the amount of requested memory.</dd></dl><h3 id="derivekey-string-or-readonlyspan-byte-readonlyspan-byte-algorithm-in-keycreationparameters">DeriveKey(string or ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;, Algorithm, in KeyCreationParameters)</h3><p>Derives a key for the specified algorithm from a password, using the specified
salt.</p><pre data-lang="C#"><span class="k">public</span> Key DeriveKey(
    <span class="k">string</span> password,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    Algorithm algorithm,
    <span class="k">in</span> KeyCreationParameters creationParameters = <span class="k">default</span>)

<span class="k">public</span> Key DeriveKey(
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; password,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; salt,
    Algorithm algorithm,
    <span class="k">in</span> KeyCreationParameters creationParameters = <span class="k">default</span>)</pre><div class="admonition note"><p class="admonition-title">Note</p><p>Depending on algorithm parameters, this method may need a long time and/or
large amounts of memory. Callers should protect against a denial-of-service
attack resulting from careless invocation.</p></div><h4>Parameters</h4><dl><dt>password</dt><dd>The password to derive the key from.</dd></dl><div class="admonition note"><p class="admonition-title">Note</p><p>If the password is a <code>string</code>, the bytes are derived from the in-memory
representation of the string. This may lead to different results on
different hardware platforms. For portable results, the password should
be first converted to bytes using one of the character encoding classes
in .NET.</p></div><dl><dt>salt</dt><dd>The salt.</dd><dt>algorithm</dt><dd>The algorithm for the new key.</dd><dt>creationParameters</dt><dd>A <a href="/docs/api/nsec.cryptography.keycreationparameters">KeyCreationParameters</a> value that specifies
advanced parameters for the creation of the <a href="/docs/api/nsec.cryptography.key">Key</a> instance.</dd></dl><h4>Return Value</h4><p>A new instance of the <a href="/docs/api/nsec.cryptography.key">Key</a> class that represents the derived key.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>password</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>salt.Length</code> is less than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#minsaltsize">MinSaltSize</a>
or greater than
<a href="/docs/api/nsec.cryptography.passwordbasedkeyderivationalgorithm#maxsaltsize">MaxSaltSize</a>.</dd><dt>ArgumentNullException</dt><dd><code>algorithm</code> is <code>null</code>.</dd><dt>NotSupportedException</dt><dd>The specified algorithm does not support keys derived from a password.</dd><dt>CryptographicException</dt><dd>The computation of the derived key failed, usually because the operating
system refused to allocate the amount of requested memory.</dd></dl><h2 id="thread-safety">Thread Safety</h2><p>All members of this type are thread safe.</p><h2 id="purity">Purity</h2><p>All methods yield the same result for the same arguments.</p><h2 id="see-also">See Also</h2><ul><li>API Reference<ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm Class</a></li><li><a href="/docs/api/nsec.cryptography.argon2parameters">Argon2Parameters Struct</a></li><li><a href="/docs/api/nsec.cryptography.keyderivationalgorithm">KeyDerivationAlgorithm Class</a></li><li><a href="/docs/api/nsec.cryptography.keyderivationalgorithm2">KeyDerivationAlgorithm2 Class</a></li><li><a href="/docs/api/nsec.cryptography.scryptparameters">ScryptParameters Struct</a></li></ul></li></ul></main><footer><p><a href="/license" rel="terms-of-use">&#169; 2025 Individual Contributors</a></p></footer></body></html>