<!DOCTYPE html>
<html lang="en"><head><title>MacAlgorithm Class | NSec</title><meta content="Represents a message authentication code (MAC) algorithm." name="description"><link href="https://nsec.rocks/docs/api/nsec.cryptography.macalgorithm" rel="canonical"><link href="/style.css" rel="stylesheet"><meta content="width=device-width, initial-scale=1" name="viewport"></head><body><header><div class="icons"><a class="icon nuget-icon" href="https://www.nuget.org/packages/NSec.Cryptography/25.4.0" title="NuGet"></a><a class="icon github-icon" href="https://github.com/ektrah/nsec" title="GitHub"></a></div><nav><ol typeof="BreadcrumbList" vocab="https://schema.org/"><li property="itemListElement" typeof="ListItem"><a href="/" property="item" typeof="WebPage"><span property="name">NSec</span></a><meta content="1" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/" property="item" typeof="WebPage"><span property="name">NSec Documentation</span></a><meta content="2" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/" property="item" typeof="WebPage"><span property="name">API Reference</span></a><meta content="3" property="position"></li> / <li property="itemListElement" typeof="ListItem"><a href="/docs/api/nsec.cryptography" property="item" typeof="WebPage"><span property="name">NSec.Cryptography</span></a><meta content="4" property="position"></li> / <li property="itemListElement" typeof="ListItem"><span property="name">MacAlgorithm</span><meta content="5" property="position"></li></ol></nav></header><main><h1>MacAlgorithm Class</h1><p>Represents a message authentication code (MAC) algorithm.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> MacAlgorithm : Algorithm</pre><h2 id="inheritance-hierarchy">Inheritance Hierarchy</h2><ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm</a><ul><li><strong>MacAlgorithm</strong><ul><li>Blake2bMac</li><li>HmacSha256</li><li>HmacSha512</li></ul></li></ul></li></ul><h2 id="summary">Summary</h2><nav><ul><li><a href="#static-properties">Static Properties</a><ul><li><a href="#blake2b_128">Blake2b_128</a></li><li><a href="#blake2b_256">Blake2b_256</a></li><li><a href="#blake2b_512">Blake2b_512</a></li><li><a href="#hmacsha256">HmacSha256</a></li><li><a href="#hmacsha256_128">HmacSha256_128</a></li><li><a href="#hmacsha512">HmacSha512</a></li><li><a href="#hmacsha512_256">HmacSha512_256</a></li></ul></li><li><a href="#properties">Properties</a><ul><li><a href="#keysize">KeySize</a></li><li><a href="#macsize">MacSize</a></li></ul></li><li><a href="#methods">Methods</a><ul><li><a href="#mac-key-readonlyspan-byte">Mac(Key, ReadOnlySpan&lt;byte&gt;)</a></li><li><a href="#mac-key-readonlyspan-byte-span-byte">Mac(Key, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</a></li><li><a href="#verify-key-readonlyspan-byte-readonlyspan-byte">Verify(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;)</a></li></ul></li><li><a href="#thread-safety">Thread Safety</a></li><li><a href="#purity">Purity</a></li><li><a href="#see-also">See Also</a></li></ul></nav><h2 id="static-properties">Static Properties</h2><h3 id="blake2b_128">Blake2b_128</h3><p>Gets the BLAKE2b algorithm with a 256-bit key and a 128-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Blake2bMac Blake2b_128 { <span class="k">get</span>; }</pre><h3 id="blake2b_256">Blake2b_256</h3><p>Gets the BLAKE2b algorithm with a 256-bit key and a 256-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Blake2bMac Blake2b_256 { <span class="k">get</span>; }</pre><h3 id="blake2b_512">Blake2b_512</h3><p>Gets the BLAKE2b algorithm with a 256-bit key and a 512-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> Blake2bMac Blake2b_512 { <span class="k">get</span>; }</pre><h3 id="hmacsha256">HmacSha256</h3><p>Gets the HMAC-SHA256 algorithm with a 256-bit key and a 256-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> HmacSha256 HmacSha256 { <span class="k">get</span>; }</pre><h3 id="hmacsha256_128">HmacSha256_128</h3><p>Gets the HMAC-SHA256 algorithm with a 256-bit key and a truncated, 128-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> HmacSha256 HmacSha256_128 { <span class="k">get</span>; }</pre><h3 id="hmacsha512">HmacSha512</h3><p>Gets the HMAC-SHA512 algorithm with a 512-bit key and a 512-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> HmacSha512 HmacSha512 { <span class="k">get</span>; }</pre><h3 id="hmacsha512_256">HmacSha512_256</h3><p>Gets the HMAC-SHA512 algorithm with a 512-bit key and a truncated, 256-bit output.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">static</span> HmacSha512 HmacSha512_256 { <span class="k">get</span>; }</pre><h2 id="properties">Properties</h2><h3 id="keysize">KeySize</h3><p>Gets the size of keys.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> KeySize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The key size, in bytes.</p><h3 id="macsize">MacSize</h3><p>Gets the size of a MAC.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">int</span> MacSize { <span class="k">get</span>; }</pre><h4>Property Value</h4><p>The MAC size, in bytes.</p><h2 id="methods">Methods</h2><h3 id="mac-key-readonlyspan-byte">Mac(Key, ReadOnlySpan&lt;byte&gt;)</h3><p>Computes a message authentication code for the specified input data using the
specified key and returns it as an array of bytes.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">byte</span>[] Mac(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; data)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The key to use for computing the message authentication code.</dd><dt>data</dt><dd>The data to authenticate.</dd></dl><h4>Return Value</h4><p>The computed message authentication code.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.macalgorithm">MacAlgorithm</a> object.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h3 id="mac-key-readonlyspan-byte-span-byte">Mac(Key, ReadOnlySpan&lt;byte&gt;, Span&lt;byte&gt;)</h3><p>Fills the specified span of bytes with a message authentication code for the
specified input data using the specified key.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">void</span> Mac(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; data,
    Span&lt;<span class="k">byte</span>&gt; mac)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The key to use for computing the message authentication code.</dd><dt>data</dt><dd>The data to authenticate.</dd><dt>mac</dt><dd>The span to fill with the computed message authentication code.</dd></dl><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.macalgorithm">MacAlgorithm</a> object.</dd><dt>ArgumentException</dt><dd><code>mac.Length</code> is not equal to <a href="/docs/api/nsec.cryptography.macalgorithm#macsize">MacSize</a>.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h3 id="verify-key-readonlyspan-byte-readonlyspan-byte">Verify(Key, ReadOnlySpan&lt;byte&gt;, ReadOnlySpan&lt;byte&gt;)</h3><p>Verifies the specified input data using the specified key and message
authentication code.</p><pre data-lang="C#"><span class="k">public</span> <span class="k">bool</span> Verify(
    Key key,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; data,
    ReadOnlySpan&lt;<span class="k">byte</span>&gt; mac)</pre><h4>Parameters</h4><dl><dt>key</dt><dd>The key to use for verification.
Verification fails if this is not the key used when computing the message
authentication code.</dd><dt>data</dt><dd>The data to verify.
Verification fails if the integrity of the data was compromised.</dd><dt>mac</dt><dd>The message authentication code for the data.</dd></dl><h4>Return Value</h4><p><code>true</code> if verification succeeds; otherwise, <code>false</code>.</p><h4>Exceptions</h4><dl><dt>ArgumentNullException</dt><dd><code>key</code> is <code>null</code>.</dd><dt>ArgumentException</dt><dd><code>key.Algorithm</code> is not the same object as the current
<a href="/docs/api/nsec.cryptography.macalgorithm">MacAlgorithm</a> object.</dd><dt>ObjectDisposedException</dt><dd><code>key</code> has been disposed.</dd></dl><h2 id="thread-safety">Thread Safety</h2><p>All members of this type are thread safe.</p><h2 id="purity">Purity</h2><p>All methods yield the same result for the same arguments.</p><h2 id="see-also">See Also</h2><ul><li>API Reference<ul><li><a href="/docs/api/nsec.cryptography.algorithm">Algorithm Class</a></li><li><a href="/docs/api/nsec.cryptography.incrementalmac">IncrementalMac Struct</a></li><li><a href="/docs/api/nsec.cryptography.key">Key Class</a></li></ul></li></ul></main><footer><p><a href="/license" rel="terms-of-use">&#169; 2025 Individual Contributors</a></p></footer></body></html>